<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Training Form</title>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js"></script>
  <style>
    label, select, input {
      display: block;
      margin: 10px 0;
    }
  </style>
</head>
<body>

  <label for="company">Training Company:</label>
  <select id="company"></select>

  <label for="trainer">Trainer:</label>
  <select id="trainer"></select>

  <label for="product">Product:</label>
  <select id="product"></select>

  <label for="courseLevel">Course Level:</label>
  <select id="courseLevel"></select>

  <label for="trainingDate">Date:</label>
  <input id="trainingDate" type="date" />

  <label for="classTime">AM / PM:</label>
  <select id="classTime">
    <option value="AM">AM</option>
    <option value="PM">PM</option>
  </select>

  <label for="location">Location:</label>
  <input id="location" type="text" placeholder="Enter location" />

  <script>
    // Firebase config (replace with your config)
    const firebaseConfig = {
  apiKey: "AIzaSyDQ5H1jO6XPDvIN5CoIvlFFta2lPGE4WIk",
  authDomain: "training-qr-code.firebaseapp.com",
  projectId: "training-qr-code",
  storageBucket: "training-qr-code.firebasestorage.app",
  messagingSenderId: "79832187763",
  appId: "1:79832187763:web:86050298cbd1262faf3b06"
};


    // Init Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // DOM references
    const companySelect = document.getElementById('company');
    const trainerSelect = document.getElementById('trainer');
    const productSelect = document.getElementById('product');
    const courseLevelSelect = document.getElementById('courseLevel');

    let trainersByCompany = {};

    // Load Companies
    db.collection('companies').get().then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const option = document.createElement('option');
        option.value = doc.id;
        option.textContent = data.name;
        companySelect.appendChild(option);
      });
      // Load trainers after companies loaded
      loadTrainers();
    });

    // Load Trainers and group by companyId
    function loadTrainers() {
      db.collection('trainers').get().then(snapshot => {
        trainersByCompany = {};
        snapshot.forEach(doc => {
          const data = doc.data();
          if (!trainersByCompany[data.companyId]) {
            trainersByCompany[data.companyId] = [];
          }
          trainersByCompany[data.companyId].push({id: doc.id, name: data.name});
        });
        updateTrainers();
      });
    }

    // When company changes, update trainers dropdown
    companySelect.addEventListener('change', updateTrainers);

    function updateTrainers() {
      const selectedCompany = companySelect.value;
      const trainers = trainersByCompany[selectedCompany] || [];
      trainerSelect.innerHTML = '';
      trainers.forEach(trainer => {
        const option = document.createElement('option');
        option.value = trainer.id;
        option.textContent = trainer.name;
        trainerSelect.appendChild(option);
      });
    }

    // Load Products
    db.collection('products').get().then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const option = document.createElement('option');
        option.value = doc.id;
        option.textContent = data.name;
        productSelect.appendChild(option);
      });
    });

    // Load Course Levels
    db.collection('courseLevels').orderBy('name').get().then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const option = document.createElement('option');
        option.value = doc.id;
        option.textContent = data.name;
        courseLevelSelect.appendChild(option);
      });
    });

  </script>
</body>
</html>
